# Comparative Genomic and Temporal Analysis of SARS-CoV-2 Lineage JN.1

## Overview

This repository includes the computational pipeline and findings from a genomic analysis of the SARS-CoV-2 JN.1 lineage. The project investigates the evolutionary divergence of JN.1 from its parental lineage, BA.2.86, to identify genetic adaptations that may explain its rapid global spread.

The above analysis is divided into two main parts, corresponding to two key research questions:

1.  **Comparative Genomics:** How does the genomic diversity of JN.1 differ from BA.2.86? This is addressed through a genome-wide sliding window analysis of nucleotide diversity (π) and a targeted scan for differentiating non-synonymous mutations.

2.  **Temporal Dynamics:** How can we visualize evolutionary events in real-time? This is addressed by tracking the frequency of two key mutations over time within the JN.1 lineage: the lineage-defining `L455S` mutation and the emerging `F456L` mutation.

The findings are summarized in two of the reports located in this directory. Other reports are also archived here.

## Repository Structure

```
.
├── README.md
├── analysis_pipeline.py
├── jn1_ba286_sliding_window.png  (Output plot)
├── jn1_s455_frequency.png        (Output plot)
├── f456l_frequency.png         (Output plot)
└── ... (data files)
```

-   **`README.md`**: This file.
-   **`analysis_pipeline.py`**: The master Python script that runs all analyses from start to finish.
-   **`*.png`**: Output plots generated by the pipeline.

## Methodology & Usage

### 1. Dependencies

This analysis requires Python 3 and several scientific libraries. They can be installed via pip:

```bash
pip install pandas numpy matplotlib seaborn biopython
```

### 2. Data Prerequisites

The script requires several large data files to be present in the same directory. Due to their size, they are not included in this repository.

-   `all_clades_aligned.fas`: A large, aligned FASTA file containing sequences from all relevant lineages.
-   `public-latest.metadata.tsv`: The corresponding metadata file from a public repository like UShER/GISAID, containing strain names, collection dates, and lineage assignments.
-   `NC_045512v2.fa`: The SARS-CoV-2 reference genome (Wuhan-Hu-1).
-   `NC_045512_2.gff3`: The GFF3 file containing gene annotations for the reference genome.

### 3. Execution

Once the dependencies are installed and the data files are in place, the entire analysis can be executed with a single command:

```bash
python analysis_pipeline.py
```

### 4. Workflow

The script will perform the following steps automatically:

1.  **Pre-processing (first run only):**
    -   It first verifies the integrity of `all_clades_aligned.fas`, creating a clean version (`verified_sequences.fas`).
    -   It then converts the clean FASTA into a high-performance memory-mapped NumPy file (`alignment.mmap`) for efficient access.
2.  **Data Loading:** It loads the metadata, GFF annotations, and the binary alignment into memory.
3.  **Comparative Diversity Analysis (Report 1: brief_report_2.md):**
    -   It calculates nucleotide diversity (π) in sliding windows for both the JN.1 and BA.2.86 (Parent) groups.
    -   It generates and saves the comparative plot `jn1_ba286_sliding_window.png`.
    -   It performs a codon-by-codon analysis of key genes and prints a table of enriched mutations in JN.1.
4.  **Temporal Sweep Analysis (Report 2: brief_report_3.md):**
    -   It tracks the weekly frequency of the Spike `L455S` mutation and saves the plot `jn1_s455_frequency.png`.
    -   It tracks the weekly frequency of the Spike `F456L` mutation and saves the plot `f456l_frequency.png`.

The script will print progress updates to the console throughout its execution.
